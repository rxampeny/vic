<!DOCTYPE html>
<html lang="ca">
<head>
    <meta property="og:image" content="escola-victor-catala.jpg">
    <link rel="icon" href="escola-victor-catala.jpg" type="image/jpeg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta property="og:image" content="https://victor-catala-1971.netlify.app/images/escola-victor-catala.jpg">
    <meta property="og:title" content="Víctor Català 1971">
    <meta property="og:description" content="Pàgina dedicada a l'escola Víctor Català, promoció de 1971">
    <meta property="og:type" content="website">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://victor-catala-1971.netlify.app/victor-catala-1971.html">
    <title>Víctor Català 1971</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            padding: 10px;
        }
        
        .container {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 100%;
            width: 100%;
        }
        
        h1 {
            text-align: center;
            color: #333;
            font-size: 1.5rem;
            margin: 10px 0;
        }
        
        h1 img {
            width: 30px;
            height: 30px;
            vertical-align: middle;
            margin-right: 8px;
        }
        
        select {
            margin-bottom: 15px;
            padding: 8px;
            font-size: 16px;
            width: 100%;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        #chartContainer {
            height: 60vh;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .imatge-container {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .imatge-container img {
            max-width: 80%;
            height: auto;
            border-radius: 8px;
        }
        
        .checkbox-container {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }
        
        .checkbox-container label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }
        
        .checkbox-container input[type="checkbox"] {
            margin: 0;
            transform: scale(1.2);
        }
        
        /* Estilos para el modal de contraseña */
        #passwordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .login-container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            text-align: center;
            width: 85%;
            max-width: 350px;
        }
        
        .login-container img {
            width: 70px;
            height: 70px;
            margin-bottom: 15px;
            border-radius: 10px;
        }
        
        .login-container h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .login-container p {
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .login-container button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
            width: 100%;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .login-container button:hover {
            background-color: #45a049;
        }
        
        .login-container input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            text-align: center;
        }
        
        #logoutButton {
            padding: 8px 15px;
            margin: 10px 0;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            align-self: flex-end;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* Botón flotante para cerrar sesión en móviles */
        @media (max-width: 768px) {
            #logoutButton {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 100;
                padding: 10px 15px;
                border-radius: 30px;
            }
            
            .mainContent {
                width: 100%;
            }
            
            .container {
                margin-bottom: 60px;
            }
        }
        
        /* Ocultar el contenido principal hasta que se verifique la contraseña */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Modal de contraseña -->
    <div id="passwordModal">
        <div class="login-container">
            <img src="escola-victor-catala.jpg" alt="Víctor Català">
            <h2>Víctor Català 1971</h2>
            <p>Si us plau, introdueix la contrassenya per accedir:</p>
            <input type="password" id="passwordInput" placeholder="contrassenya">
            <button onclick="checkPassword()">Accedir</button>
        </div>
    </div>

    <!-- Contenido principal (inicialmente oculto) -->
    <div class="mainContent hidden">
        <button id="logoutButton">Tancar sessió</button>
        
        <div class="container">
            <h1><img src="escola-victor-catala.jpg" alt="Víctor Català">Víctor Català 1971</h1>
            <div class="imatge-container">
                <img src="escola-victor-catala.jpg" alt="Imatge de l'escola Víctor Català" />
            </div>
            <select id="mesSelector"></select>
            <div class="checkbox-container">
                <label>
                    <input type="checkbox" id="mostrarTelefons">
                    Mostrar telèfons a les barres
                </label>
            </div>
            <div id="chartContainer">
                <canvas id="aniversarisChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Sistema de contraseña
        const correctPassword = "VC1971";
        
        // Función para verificar la contraseña
        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            
            if (password === correctPassword) {
                localStorage.setItem('victorCatalaAuth', 'true');
                document.getElementById('passwordModal').style.display = 'none';
                document.querySelector('.mainContent').classList.remove('hidden');
                initializeApp();
            } else {
                alert('Contrassenya incorrecta. Si us plau, intenta-ho novament.');
                document.getElementById('passwordInput').value = '';
            }
        }
        
        // BASE DE DATOS COMPLETA CON TODOS LOS TELÉFONOS
        const dadesAniversaris = [
            {nom: "César Márquez García", mes: 4, dia: 4, telefon: "660823474"},
            {nom: "Ángela", mes: 8, dia: 5, telefon: "695411577 - Ja no està en el grup!"},
            {nom: "Carlos Herrero", mes: 6, dia: 13, telefon: "653754789"},
            {nom: "Fermín", mes: 10, dia: 6, telefon: "687627716"},
            {nom: "Javier Alcázar", mes: 10, dia: 11, telefon: "654775970"},
            {nom: "Josele", mes: 4, dia: 4, telefon: "610283728"},
            {nom: "MªJosé García", mes: 7, dia: 19, telefon: "646323397"},
            {nom: "Óscar Guardado", mes: 8, dia: 6, telefon: "639975491"},
            {nom: "Yolanda Vicente", mes: 6, dia: 11, telefon: "628822655"},
            {nom: "Yolanda Martín", mes: 7, dia: 18, telefon: "678522965"},
            {nom: "Txema", mes: 12, dia: 10, telefon: "679208956"},
            {nom: "Tito", mes: 3, dia: 26, telefon: "676123034 - Ja no està en el grup!"},
            {nom: "Rubén Claver", mes: 7, dia: 16, telefon: "677258709"},
            {nom: "Rosa Garriz", mes: 1, dia: 30, telefon: "617078769"},
            {nom: "Roberto León", mes: 12, dia: 4, telefon: "678572513"},
            {nom: "Ricardo Sirera", mes: 2, dia: 24, telefon: "692869224"},
            {nom: "Rafa Xampeny", mes: 2, dia: 19, telefon: "609085519"},
            {nom: "Pedro Cilleruelo", mes: 7, dia: 11, telefon: "693056907"},
            {nom: "Nuria Romero", mes: 2, dia: 15, telefon: "655127039"},
            {nom: "Mónica Sánchez", mes: 1, dia: 5, telefon: "619455954"},
            {nom: "Mónica Pérez", mes: 12, dia: 7, telefon: "627954101"},
            {nom: "Mónica Fdez.", mes: 5, dia: 6, telefon: "686690002"},
            {nom: "Mar Gutiérrez", mes: 9, dia: 17, telefon: "629403109"},
            {nom: "Lyss Miró", mes: 11, dia: 14, telefon: "621182162"},
            {nom: "Luqui Luján", mes: 9, dia: 22, telefon: "625946641 - Ja no està en el grup!"},
            {nom: "Loli Arjona", mes: 3, dia: 20, telefon: "687460703"},
            {nom: "Juanjo Hierro", mes: 8, dia: 9, telefon: "639948864"},
            {nom: "Juan Luis López", mes: 9, dia: 13, telefon: "649144350"},
            {nom: "José Antonio Pérez", mes: 10, dia: 23, telefon: "636091794"},
            {nom: "Joel Solana", mes: 2, dia: 2, telefon: "649911518"},
            {nom: "Javier Castilla", mes: 4, dia: 19, telefon: "630575368"},
            {nom: "Ismael Sopena", mes: 8, dia: 11, telefon: "610897315"},
            {nom: "Irene Martínez", mes: 12, dia: 20, telefon: "659474612"},
            {nom: "Elena Andújar", mes: 1, dia: 21, telefon: "676785714"},
            {nom: "Carles Boldú", mes: 1, dia: 21, telefon: "647738522"},
            {nom: "Cori Cuquejo", mes: 2, dia: 26, telefon: "647619220"},
            {nom: "Salud", mes: 2, dia: 26, telefon: "646823473"},
            {nom: "Conchi Navarro", mes: 6, dia: 17, telefon: "678761063"},
            {nom: "Conchi Chueca", mes: 5, dia: 20, telefon: "616199200"},
            {nom: "Pilar Charles", mes: 4, dia: 27, telefon: "629537533"},
            {nom: "David Rosique", mes: 3, dia: 19, telefon: "660595167"}
        ];

        let chart;

        function getDiesMes(mes, any = 2025) {
            return new Date(any, mes, 0).getDate();
        }

        function getRandomColor() {
            const r = Math.floor(Math.random() * 200 + 55);
            const g = Math.floor(Math.random() * 200 + 55);
            const b = Math.floor(Math.random() * 200 + 55);
            return `rgba(${r}, ${g}, ${b}, 0.6)`;
        }

        function actualitzarGrafic(mes) {
            const aniversarisMes = dadesAniversaris.filter(d => d.mes === parseInt(mes));
            aniversarisMes.sort((a, b) => a.dia - b.dia);

            const diesMes = getDiesMes(mes);
            const mostrarTelefons = document.getElementById('mostrarTelefons').checked;

            const data = {
                labels: aniversarisMes.map(d => {
                    if (mostrarTelefons && d.telefon && d.telefon.trim() !== "") {
                        return `${d.dia} - ${d.nom} (${d.telefon})`;
                    } else {
                        return `${d.dia} - ${d.nom}`;
                    }
                }),
                datasets: [{
                    label: 'Dia de l\'aniversari',
                    data: aniversarisMes.map(d => d.dia),
                    backgroundColor: aniversarisMes.map(() => getRandomColor()),
                    borderColor: 'rgba(0, 0, 0, 0.1)',
                    borderWidth: 1
                }]
            };

            if (chart) {
                chart.destroy();
            }

            const ctx = document.getElementById('aniversarisChart').getContext('2d');
            
            // Registrar el plugin de datalabels
            Chart.register(ChartDataLabels);

            chart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: diesMes,
                            title: {
                                display: true,
                                text: 'Dia del mes'
                            }
                        },
                        y: {
                            ticks: {
                                autoSkip: false,
                                font: {
                                    size: function(context) {
                                        const width = window.innerWidth;
                                        return width < 768 ? 10 : 12;
                                    }
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: `Aniversaris de ${getMesName(mes)}`,
                            font: {
                                size: function(context) {
                                    const width = window.innerWidth;
                                    return width < 768 ? 14 : 16;
                                }
                            }
                        },
                        datalabels: {
                            display: true,
                            anchor: 'start',
                            align: 'end',
                            formatter: function(value, context) {
                                return value;
                            },
                            font: {
                                weight: 'bold',
                                size: function(context) {
                                    const width = window.innerWidth;
                                    return width < 768 ? 10 : 12;
                                }
                            },
                            color: 'black',
                            offset: 4
                        },
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function getMesName(mesNumber) {
            const mesos = ["", "Gener", "Febrer", "Març", "Abril", "Maig", "Juny", "Juliol", "Agost", "Setembre", "Octubre", "Novembre", "Desembre"];
            return mesos[parseInt(mesNumber)] || 'Mes desconegut';
        }

        function initializeApp() {
            const mesActual = new Date().getMonth() + 1;
            const mesSelector = document.getElementById('mesSelector');
            const mesos = ["Gener", "Febrer", "Març", "Abril", "Maig", "Juny", "Juliol", "Agost", "Setembre", "Octubre", "Novembre", "Desembre"];
            
            // Limpiar opciones existentes antes de añadir nuevas
            mesSelector.innerHTML = '';
            
            // Llenar el selector de meses
            mesos.forEach((mes, index) => {
                const option = document.createElement('option');
                option.value = index + 1;
                option.text = mes;
                mesSelector.appendChild(option);
            });
            
            mesSelector.value = mesActual;
            actualitzarGrafic(mesActual);
            
            // Añadir event listener para cambio de mes
            mesSelector.addEventListener('change', function() {
                actualitzarGrafic(this.value);
            });
            
            // Añadir event listener para mostrar/ocultar teléfonos
            document.getElementById('mostrarTelefons').addEventListener('change', function() {
                actualitzarGrafic(mesSelector.value);
            });
            
            checkMobileSize();
        }

        function checkMobileSize() {
            if (window.innerWidth <= 768) {
                document.querySelectorAll('.imatge-container img').forEach(img => {
                    img.style.maxWidth = '90%';
                });
            } else {
                document.querySelectorAll('.imatge-container img').forEach(img => {
                    img.style.maxWidth = '60%';
                });
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Comprobar si ya estamos autenticados
            if (localStorage.getItem('victorCatalaAuth') === 'true') {
                document.getElementById('passwordModal').style.display = 'none';
                document.querySelector('.mainContent').classList.remove('hidden');
                initializeApp();
            }
            
            // Event listener para Enter en la contraseña
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
            
            // Event listener para cerrar sesión
            document.getElementById('logoutButton').addEventListener('click', function() {
                localStorage.removeItem('victorCatalaAuth');
                document.getElementById('passwordModal').style.display = 'flex';
                document.querySelector('.mainContent').classList.add('hidden');
                document.getElementById('passwordInput').value = '';
            });
        });
        
        // Ajustar tamaño al cambiar la orientación del dispositivo
        window.addEventListener('resize', function() {
            checkMobileSize();
            const mesSelector = document.getElementById('mesSelector');
            if (mesSelector && mesSelector.value) {
                actualitzarGrafic(mesSelector.value);
            }
        });
    </script>
</body>
</html>